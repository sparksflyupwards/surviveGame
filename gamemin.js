BasicGame.Game=function(b){this.game;this.add;this.camera;this.cache;this.input;this.load;this.math;this.sound;this.stage;this.time;this.tweens;this.world;this.particles;this.physics;this.rnd}; var platformStarts=[0,524],platformSpeeds=[-40,-40,-40,-40],platformWidths=[500,500],platforms,dropPlatforms,wasDropPlatform,liftPlatforms,wasLiftPlatform,stars,greenStars,blueStars,hearts,player,heart1,heart2,heart3,spikeBars,cursors,scoreText,timeText,livesText,isDesktop,gameRef,lives=3,xpTimer=0,xpTime=800,platformTimer=0,platformTime=5500,restartTimer=0,restartTime=platformTime/6,score=0,scoreRate=1,bestScore=0,naturalVelocity=0,speedModifier=1,platformSpeedNew,showRestart=!1,show=0,one,two,three, gameIsNew=!0,bricks;function dropPlatform(b,a){a.body.velocity.y=300;a.body.acceleration.y=300;b.body.velocity.y=-300}function liftPlatform(b,a){a.body.velocity.y=-300;a.body.acceleration.y=-300;b.body.velocity.x=-800} var platformCollision=function(b,a){"accelerate"==a.name?b.body.acceleration.x=0:"jump"==a.name?(b.body.acceleration.x=0,b.body.velocity.y+=-200):"normal"==a.name&&(b.body.acceleration.x=0)},newPlatform=function(b,a,c,d){b=platformStarts[Math.floor(Math.random()*platformStarts.length)];d=d.height-90;a=a.create(b,d,c);a.body.immovable=!0;a.width=platformWidths[Math.floor(Math.random()*platformWidths.length)];a.body.velocity.y=platformSpeeds[Math.floor(Math.random()*platformSpeeds.length)]*speedModifier; platformSpeedNew=a.body.velocity.y*speedModifier;a.name=c;c=Math.floor(10*Math.random()+1);for(var f=0;f<c;f++){var e=stars.create(0,0,"star");e.body.x=a.width/c*f+b;e.body.y=d-e.height-10;e.body.gravity.y=20}};function destroyPlatform(b,a){b.kill()}function destroyStar(b,a){b.kill()}function loseLife(b,a){lives--;0>lives?BasicGame.Game.prototype.quitGame(this):(hearts.getAt(lives).kill(),livesText.content="Lives: "+lives,showRestart=!0,BasicGame.Game.prototype.restartGame(this))} function collectStar(b,a){a.kill();score+=500;scoreText.content="Score: "+score}function destroyGame(b){player.kill();platforms.removeAll();dropPlatforms.removeAll();liftPlatforms.removeAll();stars.removeAll();bricks.removeAll()} function createGame(b){gameIsNew=!0;platformTimer=b.time.now+platformTime/2;var a=spikeBars.create(0,b.world.height-32,"spikesbot");a.scale.setTo(2,2);a.body.immovable=!0;a=spikeBars.create(0,0,"spikes");a.scale.setTo(2,2);a.body.immovable=!0;a=platforms.create(0,b.world.height-64,"plate");a.body.immovable=!0;a.body.velocity.y=-80;a.width=400;a=platforms.create(400,400,"plate");a.body.immovable=!0;a.width=200;a.body.velocity.y=-80*speedModifier;a=platforms.create(-150,250,"plate");a.body.immovable= !0;a.body.velocity.y=-80*speedModifier;player=null;player=b.add.sprite(32,b.world.height-150,"dude");player.body.gravity.y=6;player.body.collideWorldBounds=!0;player.animations.add("left",[0,1,2,3],10,!0);player.animations.add("right",[5,6,7,8],10,!0);player.x=32;player.y=b.world.height-150;for(a=0;12>a;a++)stars.create(70*a,0,"star").body.gravity.y=6;isDesktop&&(cursors=b.input.keyboard.createCursorKeys())} BasicGame.Game.prototype={create:function(){isDesktop=this.game.device.desktop;xpTimer=this.time.now+xpTime;gameRef=this.game;var b=this.add.sprite(-2,-2,"sky");b.body.immovable=!0;b.body.width=1024;b.body.height=this.game.height;spikeBars=this.add.group();platforms=this.add.group();bricks=this.add.group();hearts=gameRef.add.group();dropPlatforms=this.add.group();liftPlatforms=this.add.group();stars=gameRef.add.group();jumpPlatforms=this.add.group();heart1=hearts.create(48,150,"<3");heart1.width= 32;heart1.height=32;heart1.immovable=!0;heart2=hearts.create(80,150,"<3");heart2.width=32;heart2.height=32;heart2.immovable=!0;heart3=hearts.create(112,150,"<3");heart3.width=32;heart3.height=32;heart3.immovable=!0;scoreText=gameRef.add.text(16,16,"",{fontSize:"32px",fill:"#000"});timeText=gameRef.add.text(16,100,"",{fontSize:"32px",fill:"#000"});livesText=gameRef.add.text(16,150,"",{fontSize:"32px",fill:"#000"});createGame(gameRef)},update:function(){showRestart&&this.time.now>=restartTimer&&(gameIsNew? (gameIsNew=!1,restartTimer=this.time.now+restartTime/2):restartTimer=this.time.now+restartTime,0==show?(one=gameRef.add.sprite(gameRef.world.width/2,gameRef.world.height/2,"imageof1"),show++):1==show?(one.kill(),show++):2==show?(two=gameRef.add.sprite(gameRef.world.width/2,gameRef.world.height/2,"imageof2"),show++):3==show?(two.kill(),show++):4==show?(three=gameRef.add.sprite(gameRef.world.width/2,gameRef.world.height/2,"imageof3"),show++):5==show&&(three.kill(),showRestart=!1,show=0));1<score/1E3&& (speedModifier=1+score/3E4);player.body.gravity.y=6*speedModifier;!showRestart&&this.time.now>platformTimer&&(platformTimer=this.time.now+platformTime/speedModifier,2>10*Math.random()&&!wasDropPlatform?(wasDropPlatform=!0,wasLiftPlatform=!1,newPlatform(player,dropPlatforms,"dropPlatform",gameRef)):(wasLiftPlatform=wasDropPlatform=!1,newPlatform(player,platforms,"plate",gameRef)));this.physics.collide(player,platforms);this.physics.collide(platforms,bricks);this.physics.collide(stars,bricks);this.physics.collide(stars, platforms);this.physics.collide(stars,dropPlatforms);this.physics.collide(stars,liftPlatforms);this.physics.overlap(player,dropPlatforms,dropPlatform,null,gameRef);this.physics.collide(player,liftPlatforms,liftPlatform,null,gameRef);this.physics.overlap(player,stars,collectStar,null,this);this.physics.overlap(platforms,spikeBars,destroyPlatform,null,gameRef);this.physics.overlap(stars,spikeBars,destroyStar,null,gameRef);this.physics.collide(player,spikeBars,loseLife,null,gameRef);350<=Math.abs(player.body.velocity.x)&& (player.body.acceleration.x=0);isDesktop?(cursors.left.isDown?(player.body.velocity.x=-150*speedModifier,player.animations.play("left")):cursors.right.isDown?(player.body.velocity.x=150*speedModifier,player.animations.play("right")):(player.animations.stop(),player.body.velocity.x=0,player.frame=4),cursors.up.isDown&&player.body.touching.down&&(player.body.velocity.y=-200*speedModifier,0>player.body.velocity.x?player.body.velocity.x-=300*speedModifier:0<player.body.velocity.x&&(player.body.velocity.x+= 300*speedModifier))):(timeText.content="touching",this.input.x<=this.game.width/2?(player.animations.play("left"),player.body.velocity.x=-150*speedModifier):this.input.x>=1*this.game.width/2?(player.animations.play("right"),player.body.velocity.x=150*speedModifier):(player.body.velocity.x=0,player.frame=4))},quitGame:function(b){lives=3;score>bestScore&&(bestScore=score);speedModifier=1;destroyGame(b);b.state.start("MainMenu")},restartGame:function(b){speedModifier=1;destroyGame(b);createGame(b)}};
